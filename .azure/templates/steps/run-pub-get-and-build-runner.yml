parameters:
  - name: RunIntlGeneration
    type: boolean
    default: true
  - name: WorkingDirectory
    type: string

steps:
  - script: flutter pub get
    displayName: Run Pub Get
    workingDirectory: ${{ parameters.WorkingDirectory }}

  - ${{ if eq(parameters.RunIntlGeneration, true) }}:
    - script: flutter pub global activate intl_utils
      displayName: Activate int_utils
      workingDirectory: ${{ parameters.WorkingDirectory }}

  - ${{ if eq(parameters.RunIntlGeneration, true) }}:
    - script: flutter pub global run intl_utils:generate
      displayName: Run localization file generation
      workingDirectory: ${{ parameters.WorkingDirectory }}

  - script: flutter pub run build_runner build
    displayName: Run code generation
    workingDirectory: ${{ parameters.WorkingDirectory }}