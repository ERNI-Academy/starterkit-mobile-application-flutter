parameters:
  - name: Command
    type: object

steps:
  - task: PowerShell@2
    inputs:
      targetType: "inline"
      script: |
        $SecretsJson = Get-Content ".secrets/$(APP_ENVIRONMENT).secrets" | out-string | ConvertFrom-Json
        ${{ parameters.Command }}
      workingDirectory: $(WorkingDirectory)
    displayName: Run command with secrets as JSON
